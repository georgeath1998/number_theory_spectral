clear; clc;


T = 144;            
num_zeros = 50;    
k_vals = linspace(2, 50, 500); 

rho = [ ...
   0.5 + 14.1347251417347i,
0.5 + 21.0220396387716i,
0.5 + 25.0108575801457i,
0.5 + 30.4248761258595i,
0.5 + 32.9350615877392i,
0.5 + 37.5861781588257i,
0.5 + 40.9187190121475i,
0.5 + 43.327073280915i,
0.5 + 48.0051508811672i,
0.5 + 49.7738324776723i,
0.5 + 52.9703214777145i,
0.5 + 56.4462476970634i,
0.5 + 59.3470440026024i,
0.5 + 60.8317785246098i,
0.5 + 65.1125440480816i,
0.5 + 67.0798105294942i,
0.5 + 69.546401711174i,
0.5 + 72.0671576744819i,
0.5 + 75.7046906990839i,
0.5 + 77.1448400688748i,
0.5 + 79.3373750202494i,
0.5 + 82.910380854086i,
0.5 + 84.7354929805171i,
0.5 + 87.4252746131252i,
0.5 + 88.8091112076345i,
0.5 + 92.4918992705585i,
0.5 + 94.6513440405199i,
0.5 + 95.8706342282453i,
0.5 + 98.8311942181937i,
0.5 + 101.317851005731i,
0.5 + 103.725538040478i,
0.5 + 105.446623052326i,
0.5 + 107.168611184276i,
0.5 + 111.02953554317i,
0.5 + 111.874659176993i,
0.5 + 114.320220915453i,
0.5 + 116.226680320858i,
0.5 + 118.790782865976i,
0.5 + 121.370125002421i,
0.5 + 122.946829293553i,
0.5 + 124.256818554346i,
0.5 + 127.516683879596i,
0.5 + 129.578704199956i,
0.5 + 131.087688530933i,
0.5 + 133.497737202998i,
0.5 + 134.756509753374i,
0.5 + 138.116042054533i,
0.5 + 139.736208952121i,
0.5 + 141.123707404021i,
0.5 + 143.111845807621i];
zeta_prime_rho = [0.783296511867031 + 0.124699829748171i,
1.10929556346267 - 0.248729788516499i,
1.29579560500884 + 0.450036709437866i,
1.12013084524449 - 0.667509469349491i,
1.16057006749357 + 0.750554150342261i,
1.85346624998295 - 0.561004420495772i,
1.45951733467199 - 0.302868935446101i,
1.46408757414581 + 1.10372579262141i,
1.03392979847194 - 1.17886041598782i,
1.26089364678424 + 0.650781025236235i,
2.34497063266745 + 0.624018192393252i,
2.21680853789144 - 0.832391575947226i,
1.26015151261487 - 0.590881578746291i,
0.855936503982157 + 1.41547835276601i,
1.65158207573058 - 1.58310121727211i,
1.78007607549082 + 0.111737234202622i,
2.1120179422006 + 0.565098289987482i,
2.78442039783221 + 1.0175779107894i,
0.975756974226903 - 1.4881928193913i,
1.36812118170055 + 0.502667718581895i,
1.96736764082022 + 1.75724449650986i,
2.01039191929464 - 1.69079538293161i,
2.15519310618321 + 0.168613187806924i,
1.71982088312274 - 0.532740946434623i,
1.15019136183955 + 1.84771246779889i,
2.17985014757681 - 2.06852108511383i,
1.27362844322013 - 0.75266287773738i,
0.984583925164447 + 1.37794742374201i,
3.51356243707126 + 0.124487414212438i,
3.04491049754502 - 0.824814916610924i,
1.9181860435388 - 1.00908286918867i,
1.82114826275405 + 0.440586277880556i,
1.7501537068394 + 2.41500544032007i,
0.231297775273509 - 1.57394141239032i,
1.19351557883738 + 0.654409658019567i,
2.53120364420837 + 0.276661973554644i,
2.77067940680154 + 1.43231769057958i,
3.85176223825318 - 0.526776603804735i,
1.60022422190409 - 1.64500147161616i,
1.55913850848595 + 0.00470204224220579i,
0.853724768591789 + 2.15283888326751i,
3.35589030991091 - 2.06134296665923i,
2.03266468222797 - 1.16719502343201i,
2.19254709479097 + 0.757296943765615i,
2.24467443586539 - 0.449641455338678i,
1.48083085512795 + 2.39700409919932i,
1.67723153642907 - 2.67790008829942i,
1.67450834286549 - 0.664393386290374i,
1.65588376695138 + 1.15367611928935i,
2.98549070431846 + 2.26881665198308i
];
alpha=[
-1.18447431294679 - 0.314293332466739i,
-2.14968647109816 + 0.563929519753759i,
-2.64052235470438 - 1.3471023069211i,
-2.42125371695143 + 2.20374961725934i,
-2.44991729087933 - 2.69396395980847i,
-4.96937005447738 + 1.98722830428048i,
-4.33839580476607 + 1.33910302150138i,
-3.40379530530396 - 4.5515438986915i,
-1.75035284827869 + 5.18206842928038i,
-3.70416746794133 - 3.55849913413393i,
-7.77107477233655 - 2.93197210673667i,
-7.55309133901911 + 3.90751868819023i,
-4.37395692439492 + 3.95479001457852i,
-0.0491884613723785 - 6.97088372455177i,
-4.19673408785558 + 8.33835915205745i,
-7.62001955762535 - 1.14402847270908i,
-8.70124563405241 - 3.24949127210958i,
-10.7669546826227 - 6.11697156233972i,
-0.562385835317187 + 8.69912275403528i,
-6.20545654698933 - 4.25822682590746i,
-5.97300175677971 - 10.4387411597125i,
-6.46021187990197 + 10.8274524692498i,
-10.5912705869055 - 2.14429562148812i,
-8.30264311430495 + 5.35209043492871i,
-0.08523371331755 - 11.7669182880499i,
-7.03517865426817 + 13.3069032495162i,
-5.81027939925114 + 7.11830670449224i,
-0.498496496721285 - 10.2817699064399i,
-17.9922272144453 - 0.482570349740816i,
-15.7625282369355 + 5.70916657828066i,
-9.4019918367495 + 8.44619931806328i,
-11.0303114923351 - 3.67257133287275i,
-2.7870498999061 - 16.7734596420598i,
8.37088235430036 + 9.14940500582761i,
-5.54098235063582 - 9.44073350400372i,
-15.2970503354714 - 1.61431810338565i,
-14.2060730119236 - 12.0084926736137i,
-22.1032532983594 + 3.8041688315272i,
-5.33782359671121 + 14.0742328573052i,
-11.7712995461912 + 0.670029760806558i,
4.22946404177965 - 15.4143739664668i,
-16.5862634070919 + 17.4306182380595i,
-11.6610749544388 + 11.5182419745719i,
-13.5340749099673 - 8.83880821405107i,
-15.2045941501298 + 7.4210887584297i,
0.616293059671368 - 20.2838116149265i,
-1.39253076432154 + 21.565421680681i,
-12.1715504559583 + 7.67266558776629i,
-9.05112865411612 - 12.7058068947103i,
-14.6486030368656 - 20.366325581914i
];


phi_k = zeros(size(k_vals));

for idx = 1:length(k_vals)
    k = k_vals(idx);
    sum_rho = 0;
    for j = 1:length(rho)
        sum_rho = sum_rho + k^rho(j).*alpha(j)./zeta_prime_rho(j);
    end
    phi_k(idx) = (2*pi / T) * real(sum_rho);
end

figure;
plot(k_vals, phi_k, 'b-');
xlabel('k');
ylabel('phi(k) (approx)');
title('Spectral approximation of phi(k)');
grid on;
